<form method="POST" id="activity-form" hx-post="." hx-target="#activity-form">
    {% csrf_token %}
    
    <div class="space-y-6">
        <!-- Basic Information -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="{{ form.name.id_for_label }}" class="block text-sm font-medium text-gray-700">
                    Activity Name *
                </label>
                {{ form.name }}
                {% if form.name.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.name.errors.0 }}</p>
                {% endif %}
            </div>

            <div>
                <label for="{{ form.contribution_type.id_for_label }}" class="block text-sm font-medium text-gray-700">
                    Contribution Type *
                </label>
                {{ form.contribution_type }}
                {% if form.contribution_type.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.contribution_type.errors.0 }}</p>
                {% endif %}
            </div>
        </div>

        <!-- Description -->
        <div>
            <label for="{{ form.description.id_for_label }}" class="block text-sm font-medium text-gray-700">
                Description
            </label>
            {{ form.description }}
            {% if form.description.errors %}
                <p class="mt-1 text-sm text-red-600">{{ form.description.errors.0 }}</p>
            {% endif %}
        </div>

        <!-- Amount Fields -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="amount-fields">
            <div>
                <label for="{{ form.base_amount.id_for_label }}" class="block text-sm font-medium text-gray-700">
                    {% if form.contribution_type.value == 'installment' %}
                        Installment Amount *
                    {% elif form.contribution_type.value == 'monthly' %}
                        Monthly Amount *
                    {% else %}
                        Amount *
                    {% endif %}
                </label>
                {{ form.base_amount }}
                {% if form.base_amount.help_text %}
                    <p class="mt-1 text-sm text-gray-500">{{ form.base_amount.help_text }}</p>
                {% endif %}
                {% if form.base_amount.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.base_amount.errors.0 }}</p>
                {% endif %}
            </div>

            <div id="deposit-field" 
                {% if form.contribution_type.value != 'installment' %}class="hidden"{% endif %}>
                <label for="{{ form.deposit_amount.id_for_label }}" class="block text-sm font-medium text-gray-700">
                    Deposit Amount
                </label>
                {{ form.deposit_amount }}
                {% if form.deposit_amount.help_text %}
                    <p class="mt-1 text-sm text-gray-500">{{ form.deposit_amount.help_text }}</p>
                {% endif %}
                {% if form.deposit_amount.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.deposit_amount.errors.0 }}</p>
                {% endif %}
            </div>

            <div id="installment-field" 
                {% if form.contribution_type.value != 'installment' %}class="hidden"{% endif %}>
                <label for="{{ form.installment_count.id_for_label }}" class="block text-sm font-medium text-gray-700">
                    Number of Installments
                </label>
                {{ form.installment_count }}
                {% if form.installment_count.help_text %}
                    <p class="mt-1 text-sm text-gray-500">{{ form.installment_count.help_text }}</p>
                {% endif %}
                {% if form.installment_count.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.installment_count.errors.0 }}</p>
                {% endif %}
            </div>
        </div>

        <!-- Recurring Option -->
        <div id="recurring-field" 
            {% if form.contribution_type.value != 'monthly' %}class="hidden"{% endif %}>
            <div class="flex items-center">
                {{ form.is_recurring }}
                <label for="{{ form.is_recurring.id_for_label }}" class="ml-2 block text-sm font-medium text-gray-700">
                    Recurring Monthly Contribution
                </label>
            </div>
            {% if form.is_recurring.help_text %}
                <p class="mt-1 text-sm text-gray-500">{{ form.is_recurring.help_text }}</p>
            {% endif %}
            {% if form.is_recurring.errors %}
                <p class="mt-1 text-sm text-red-600">{{ form.is_recurring.errors.0 }}</p>
            {% endif %}
        </div>

        <!-- Date Fields -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="{{ form.start_date.id_for_label }}" class="block text-sm font-medium text-gray-700">
                    Start Date *
                </label>
                {{ form.start_date }}
                {% if form.start_date.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.start_date.errors.0 }}</p>
                {% endif %}
            </div>

            <div>
                <label for="{{ form.end_date.id_for_label }}" class="block text-sm font-medium text-gray-700">
                    End Date
                </label>
                {{ form.end_date }}
                {% if form.end_date.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.end_date.errors.0 }}</p>
                {% endif %}
            </div>
        </div>

        <!-- Activity Summary -->
        <div id="activity-summary" class="p-4 bg-blue-50 rounded-md hidden">
            <h4 class="font-semibold text-blue-800 mb-2">Activity Summary:</h4>
            <p id="summary-text" class="text-blue-700"></p>
        </div>
    </div>

    <div class="flex justify-end space-x-3 mt-6">
        <a href="{% url 'genesis:activity_list' %}"
            class="bg-gray-200 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2">
            Cancel
        </a>
        <button type="submit"
            class="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
            Create Activity
        </button>
    </div>
</form>

<script>
// The same JavaScript as above for dynamic form updates
document.addEventListener('DOMContentLoaded', function() {
    // ... (same JavaScript code as above)
});
</script>